{{define "title"}}Å parovec | Tags{{end}}

<!---->

{{define "content"}}
<div class="flex flex-wrap gap-5 justify-between items-center">
  <h1 class="text-5xl font-semibold">Transactions</h1>
  <button class="shadow-lg btn btn-primary" onclick="show_create_dialog()">
    <svg
      xmlns="http://www.w3.org/2000/svg"
      viewBox="0 0 24 24"
      fill="none"
      stroke="currentColor"
      stroke-width="2"
      stroke-linecap="round"
      stroke-linejoin="round"
      class="mr-2 w-6 h-6"
    >
      <path d="M5 12h14" />
      <path d="M12 5v14" />
    </svg>

    Add Transaction
  </button>
</div>

<div class="overflow-x-auto mt-6 shadow-lg card bg-base-100 overflow-y-clip">
  <div class="card-body">
    <table class="table">
      <thead>
        <tr>
          <th>Name</th>
          <th class="text-end">Value</th>
          <th>Tags</th>
          <th>Date</th>
          <th></th>
        </tr>
      </thead>
      <tbody id="transactions_table">
        {{range .Transactions}}
        <!---->
        {{template "transaction-row" .}}
        <!---->
        {{else}}
        <tr>
          <td colspan="5" class="text-lg font-light text-center">
            No transactions
          </td>
        </tr>
        {{end}}
      </tbody>
    </table>
  </div>
</div>

{{template "transaction-dialog" .}}

<script>
  function show_create_dialog() {
    transaction_form.reset();

    transaction_submit_type.value = "create";

    transaction_alert.style.display = "none";
    transaction_dialog.showModal();
  }

  /**
   * @typedef Transaction
   * @type {object}
   * @property {number} id
   * @property {string} name
   * @property {(create|update)} type
   * @property {string} value
   * @property {string} date
   * @property {string} tag
   */

  /**
   * @param {Transaction} transaction
   */
  function show_update_dialog(transaction) {
    transaction_form.reset();

    transaction_submit_type.value = "update";
    transaction_id.value = transaction.id;
    transaction_name.value = transaction.name;
    transaction_type_outcome.checked = transaction.type === "outcome";
    transaction_type_income.checked = transaction.type === "income";
    transaction_value.value = transaction.value;
    transaction_date.value = transaction.date;
    transaction_tag.value = transaction.tag;

    transaction_dialog.showModal();
  }

  // Handle save errors
  document.body.addEventListener("saveError", function (evt) {
    transaction_alert_message.innerHTML = evt.detail.value;
    transaction_alert.style.display = "grid";
  });

  // Handle save success
  document.body.addEventListener("saveSuccess", function (evt) {
    transaction_dialog.close();
  });
</script>

{{end}}
